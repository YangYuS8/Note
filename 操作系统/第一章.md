# 第一章 计算机操作系统概述

## 思维导图

![image-20251216012509219](./%E7%AC%AC%E4%B8%80%E7%AB%A0.assets/image-20251216012509219.png)

![image-20251216015156351](./%E7%AC%AC%E4%B8%80%E7%AB%A0.assets/image-20251216015156351.png)

![image-20251216021233713](./%E7%AC%AC%E4%B8%80%E7%AB%A0.assets/image-20251216021233713.png)

![image-20251216023056522](./%E7%AC%AC%E4%B8%80%E7%AB%A0.assets/image-20251216023056522.png)

![image-20251216035850407](./%E7%AC%AC%E4%B8%80%E7%AB%A0.assets/image-20251216035850407.png)

![image-20251221021507416](./%E7%AC%AC%E4%B8%80%E7%AB%A0.assets/image-20251221021507416.png)

![image-20251221023411164](./%E7%AC%AC%E4%B8%80%E7%AB%A0.assets/image-20251221023411164.png)

## 三种基本OS类型

### 批处理

单道批处理：引入脱机输入/输出技术，并由监督程序负责控制作业的输入、输出

- 主要优点:缓解了一定程度的人机速度矛盾，资源利用率有所提升。
- 主要缺点:内存中仅能有一道程序运行，只有该程序运行结束之后才能调入下一道程序。CPU有大量的时间是在空闲等待I/O完成。资源利用率依然很低。

![image-20251216020136375](./%E7%AC%AC%E4%B8%80%E7%AB%A0.assets/image-20251216020136375.png)

多道批处理：每次往内存中读入多道程序，此时操作系统正式诞生，用于支持多道程序并发运行

- 主要优点:多道程序并发执行，共享计算机资源。资源利用率大幅提升，CPU和其他资源更能保持“忙碌”状态，系统吞吐量增大。
- 主要缺点:用户响应时间长，没有人机交互功能(用户提交自己的作业之后就只能等待计算机处理完成，中间不能控制自己的作业执行。eg:无法调试程序/无法在程序运行过程中输入一些参数)

![image-20251216020448961](./%E7%AC%AC%E4%B8%80%E7%AB%A0.assets/image-20251216020448961.png)

### 分时

计算机以时间片为单位轮流为各个用户/作业服务，各个用户可通过终端与计算机进行交互

- 主要优点:用户请求可以被即时响应，解决了人机交互问题。允许多个用户同时使用一台计算机，并且用户对计算机的操作相互独立，感受不到别人的存在。
- 主要缺点:不能优先处理一些紧急任务。操作系统对各个用户/作业都是完全公平的，循环地为每个用户/作业服务一个时间片，不区分任务的紧急性。

### 实时

在实时操作系统的控制下，计算机系统接收到外部信号后及时进行处理，并且要在严格的时限内处理完事件。实时操作系统的主要特点是及时性和可靠性

硬实时系统：必须在绝对严格的规定时间内完成处理

软实时系统：能接受偶尔违反时间规定

- 主要优点:能够优先响应一些紧急任务，某些紧急任务不需时间片排队。

## 多道程序设计【待施工】

建议参考习题复习

## 并发VS并行（进程并发、设备并行）

并发:指两个或多个事件在同一时间间隔内发生。这些事件宏观上是同时发生的，但微观上是交替发生的。

并行:指两个或多个事件在同一时刻同时发生。

> eg:
>
> - 并行约会:同一时刻同时进行两个约会任务
> - 并发约会:宏观上看，这一天在同时进行两个约会任务。微观上看，在某一时刻，老渣最多正在进行一个约会任务

操作系统的并发性指计算机系统中“同时”运行着多个程序，这些程序宏观上看是同时运行着的，而微观上看是交替运行的。

操作系统就是伴随着“多道程序技术”而出现的。因此，操作系统和程序并发是一起诞生的。

- 单核CPU同一时刻只能执行一个程序，各个程序只能并发地执行
- 多核CPU同一时刻可以同时执行多个程序，多个程序可以并行地执行

### 并发与共享互为存在条件

并发性指计算机系统中同时存在着多个运行着的程序。

共享性是指系统中的资源可供内存中多个并发执行的进程共同使用。

> eg:使用QQ发送文件A，同时使用微信发送文件B。
>
> 1. 两个进程正在并发执行(并发性)
>2. 需要共享地访问硬盘资源(共享性)
> 
> 如果失去并发性，则系统中只有一个程序正在运行，则共享性失去存在的意义
>
> 如果失去共享性，则QQ和微信不能同时访问硬盘资源，就无法实现同时发送文件，也就无法并发

## 中断和异常

“中断”是让操作系统内核夺回CPU使用权的唯一途径

- 

内中断：与当前执行的指令有关，中断信号来源于CPU内部

> 若当前执行的指令是非法的，则会引发一个中断信号
>
> eg1:试图在用户态下执行特权指令；
>
> eg2:执行除法指令时发现除数为0；
>
> eg3:有时候应用程序想请求操作系统内核的服务，此时会执行一条特殊的指令——陷入指令，该指令会引发一个内部中断信号(执行“陷入指令”，意味着应用程序主动地将CPU控制权还给操作系统内核。系统调用”就是通过陷入指令完成的)；

外中断：与当前执行的指令无关，中断信号来源于CPU外部

> eg:时钟中断——由时钟部件发来的中断信号

![image-20251222064242522](./%E7%AC%AC%E4%B8%80%E7%AB%A0.assets/image-20251222064242522.png)

不同的中断信号，需要用不同的中断处理程序来处理。当CPU检测到中断信号后，会根据中断信号的类型去查询“中断向量表”，以此来找到相应的中断处理程序在内存中的存放位置。

显然，中断处理程序一定是内核程序，需要运行在“内核态”

## 系统调用

“系统调用”是操作系统提供给应用程序(程序员/编程人员)使用的接口，可以理解为一种可供应用程序调用的特殊函数，应用程序可以通过系统调用来请求获得操作系统内核的服务

> eg:去学校打印店打印论文，你按下了WPS的“打印”选项，打印机开始工作。你的论文打印到一半时，另一位同学按下了Word的“打印”按钮，开始打印他自己的论文。
>
> Q:如果两个进程可以随意地、并发地共享打印机资源，会发生什么情况?
>
> A:两个进程并发运行，打印机设备交替地收到WPS 和 Word 两个进程发来的打印请求，结果两篇论文的内容混杂在一起了….
>
> 解决方法:由操作系统内核对共享资源进行统一的管理，并向上提供“系统调用”，用户进程想要使用打印机这种共享资源，只能通过系统调用向操作系统内核发出请求。内核会对各个请求进行协调处理。

应用程序通过系统调用请求操作系统的服务。而系统中的各种共享资源都由操作系统内核统一掌管，因此凡是与共享资源有关的操作(如存储分配、I/O操作、文件管理等)，都必须通过系统调用的方式向操作系统内核提出服务请求，由操作系统内核代为完成。这样可以保证系统的稳定性和安全性，防止用户进行非法操作。

![image-20251221021016358](./%E7%AC%AC%E4%B8%80%E7%AB%A0.assets/image-20251221021016358.png)

过程:传递系统调用参数→执行陷入指令(用户态)→执行相应的内请求核程序处理系统调用(核心态)→返回应用程序

注意:

1. 陷入指令是在用户态执行的，执行陷入指令之后立即引发一个内中断，使CPU进入核心态
2. 发出系统调用请求是在用户态，而对系统调用的相应处理在核心态下进行

## 唯一途径【待施工】

## 内核、微内核

内核是操作系统最基本、最核心的部分。实现操作系统内核功能的那些程序就是内核程序。

![image-20251221022001871](./%E7%AC%AC%E4%B8%80%E7%AB%A0.assets/image-20251221022001871.png)

注意:

- 操作系统内核需要运行在内核态；
- 操作系统的非内核功能运行在用户态。

> eg:现在，应用程序想要请求操作系统的服务，这个服务的处理同时涉及到进程管理、存储管理、设备管理
>
> ![image-20251221022840369](./%E7%AC%AC%E4%B8%80%E7%AB%A0.assets/image-20251221022840369.png)

注意:变态的过程是有成本的，要消耗不少时间，频繁地变态会降低系统性能

